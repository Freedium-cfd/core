<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title></title>
	
    <meta name="description" content="Your paywall breakthrough for medium.com!" />
    <meta name="keywords" content="medium, paywall, medium.com, paywall breakthrough" />
    <link rel="stylesheet" href="https://unpkg.com/tailwindcss@2.2.19/dist/tailwind.min.css"/>
	<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#00aba9">
<meta name="msapplication-TileColor" content="#00aba9">
<meta name="theme-color" content="#ffffff">
    <script src="https://cdn.jsdelivr.net/npm/lightense-images@1.0.17/dist/lightense.min.js"></script>
  </head>

<body class="bg-gray-100 font-sans leading-normal tracking-normal">
	<nav id="header" class="fixed w-full z-10 top-0">
	

		<div id="progress" class="h-1 z-20 top-0" style="background:linear-gradient(to right, #4dc0b5 var(--scroll), transparent 0);"></div>

		<div class="w-full md:max-w-4xl mx-auto flex flex-wrap items-center justify-between mt-0 py-3">

			<div class="pl-4">
				<a class="text-green-500 text-base no-underline hover:no-underline font-extrabold text-xl" href="/" onclick="navigateToOrigin()">
					Freedium βeta
				</a>
			</div>

			<div class="block lg:hidden pr-4">
				<button id="nav-toggle" class="flex items-center px-3 py-2 border rounded text-gray-500 border-gray-600 hover:text-gray-900 hover:border-green-500 appearance-none focus:outline-none">
					<svg class="fill-current h-3 w-3" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
						<title>Menu</title>
						<path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z" />
					</svg>
				</button>
			</div>

			<div class="w-full flex-grow lg:flex lg:items-center lg:w-auto hidden lg:block mt-2 lg:mt-0 bg-gray-100 z-20" id="nav-content">
				<ul class="list-reset lg:flex justify-end flex-1 items-center">
					<!--
					<li class="mr-3">
						<a class="inline-block py-2 px-4 text-gray-900 font-bold no-underline" href="#">Active</a>
					</li>
					-->
					<li class="mr-3">
						<a class="inline-block text-gray-600 no-underline hover:text-gray-900 hover:text-underline py-2 px-4" href="https://medium.com/">Medium.com</a>
					</li>
					<!--
					<li class="mr-3">
						<a class="inline-block text-gray-600 no-underline hover:text-gray-900 hover:text-underline py-2 px-4" href="#">link</a>
					</li>
				-->
				</ul>
			</div>
		</div>
	</nav>



<div class="container w-full md:max-w-3xl mx-auto pt-20 break-words">
    <div class="w-full px-4 md:px-6 text-xl text-gray-800 leading-normal" style="font-family:Georgia,serif">
        <div class="font-sans">
            <p class="text-base md:text-sm text-green-500 font-bold pb-3">
                <a href="https://medium.com/@hnasr/how-slow-is-select-8d4308ca1f0c" class="text-sm md:text-sm text-green-500 font-bold no-underline hover:underline ">&lt; Go to the original</a>
            </p>
            
                <img alt="Preview image"
                     style="max-height: 65vh;
                            width: auto;
                            margin: auto"
                     loading="eager"
                     role="presentation"
                     src="https://miro.medium.com/v2/resize:fit:700/1*NkVVGY1zIrgCD7y8fofe0g@2x.jpeg">
            
            <h1 class="font-bold font-sans break-normal text-gray-900 pt-6 pb-2 text-3xl md:text-4xl">How Slow is SELECT * ?</h1>
            <h2 class="font-medium font-sans break-normal text-gray-600 pt-1 pb-3 text-1xl md:text-1xl">In a row-store database engine, rows are stored in units called pages. Each page has a fixed header and contains multiple rows, with each…</h2>
        </div>
        <div class="bg-gray-100 border border-gray-300 m-2">
            <div class="flex items-center space-x-4 p-4">
                <div class="flex-shrink-0">
                    <a href="https://medium.com/@hnasr" target="_blank" title="Software Engineer passionate about Backend Engineering, Get access to all my articles by joining medium https://medium.com/@hnasr/membership" class="block relative">
                        <img src="https://miro.medium.com/v2/resize:fill:88:88/1*j-h09TiaKTgYsIvVAHPa4Q@2x.jpeg"
                             alt="Hussein Nasser"
                             class="rounded-full h-11 w-11 no-lightense">
                        <div class="absolute bottom-0 right-0 h-3 w-3 border-2 border-white bg-green-500 rounded-full"></div>
                    </a>
                </div>
                <div class="flex-grow">
                    <a href="https://medium.com/@hnasr"
                       target="_blank"
                       title="Software Engineer passionate about Backend Engineering, Get access to all my articles by joining medium https://medium.com/@hnasr/membership"
                       class="block font-semibold text-gray-900">Hussein Nasser</a>
                    <button class="text-sm text-white bg-green-500 px-3 py-1 rounded-lg mt-1">
                        <a href="https://medium.com/@hnasr"
                           target="_blank"
                           title="Software Engineer passionate about Backend Engineering, Get access to all my articles by joining medium https://medium.com/@hnasr/membership"
                           class="block text-sm text-white">Follow</a>
                    </button>
                </div>
            </div>
            <div class="px-4 pb-2">
                <div class="flex flex-wrap items-center space-x-2 text-sm text-gray-500">
                    
                    <span class="text-gray-500">~4 min read</span>
                    <span class="md:inline">·</span>
                    <span class="text-gray-500">April 16, 2023 (Updated: June 17, 2023)</span>
                    <span class="md:inline">·</span>
                    <span class="text-yellow-500">Free: No</span>
                </div>
            </div>
        </div>
        <p class="leading-8 mt-7">In a row-store database engine, rows are stored in units called pages. Each page has a fixed header and contains multiple rows, with each row having a record header followed by its respective columns. For instance, consider the following example in PostgreSQL:</p><div class="mt-7"><img alt="" style="margin: auto;" class="pt-5" loading="lazy" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:700/1*pHmjLG59FPCk6vVBzbqrRA@2x.jpeg"></div><p class="leading-8 mt-7">When the database fetches a page and places it in the shared buffer pool, we gain access to all rows and columns within that page. So, the question arises: if we have all the columns readily available in memory, why would SELECT * be slow and costly? Is it really as slow as people claim it to be? And if so why is it so? In this post, we will explore these questions and more.</p><h1 class="font-bold font-sans break-normal text-gray-900 text-1xl md:text-2xl pt-12">Kiss Index-Only Scans Goodbye</h1><p class="leading-8 mt-3">Using SELECT * means that the database optimizer cannot choose index-only scans. For example, let’s say you need the IDs of students who scored above 90, and you have an index on the grades column that includes the student ID as a non-key, this index is perfect for this query.</p><p class="leading-8 mt-7">However, since you asked for all fields, the database needs to access the heap data page to get the remaining fields increasing random reads resulting in far more I/Os. In contrast, the database could have only scanned the grades index and returned the IDs if you hadn’t used SELECT *.</p><h1 class="font-bold font-sans break-normal text-gray-900 text-1xl md:text-2xl pt-12">Deserialization Cost</h1><p class="leading-8 mt-3">Deserialization, or decoding, is the process of converting raw bytes into data types. This involves taking a sequence of bytes (typically from a file, network communication, or another source) and converting it back into a more structured data format, such as objects or variables in a programming language.</p><p class="leading-8 mt-7">When you perform a SELECT * query, the database needs to deserialize all columns, even those you may not need for your specific use case. This can increase the computational overhead and slow down query performance. By only selecting the necessary columns, you can reduce the deserialization cost and improve the efficiency of your queries.</p><h1 class="font-bold font-sans break-normal text-gray-900 text-1xl md:text-2xl pt-12">Not All Columns Are Inline</h1><p class="leading-8 mt-3">One significant issue with SELECT * queries is that not all columns are stored inline within the page. Large columns, such as text or blobs, may be stored in external tables and only retrieved when requested (Postgres TOAST tables are example). These columns are often compressed, so when you perform a SELECT * query with many text fields, geometry data, or blobs, you place an additional load on the database to fetch the values from external tables, decompress them, and return the results to the client.</p><h1 class="font-bold font-sans break-normal text-gray-900 text-1xl md:text-2xl pt-12">Network Cost</h1><p class="leading-8 mt-3">Before the query result is sent to the client, it must be serialized according to the communication protocol supported by the database. The more data needs to be serialized, the more work is required from the CPU. After the bytes are serialized, they are transmitted through TCP/IP. The more segments you need to send, the higher the cost of transmission, which ultimately affects network latency.</p><p class="leading-8 mt-7">Returning all columns may require deserialization of large columns, such as strings or blobs, that clients may never use.</p><h1 class="font-bold font-sans break-normal text-gray-900 text-1xl md:text-2xl pt-12">Client Deserialization</h1><p class="leading-8 mt-3">Once the client receives the raw bytes, the client app must deserialize the data to whatever language the client uses, adding to the overall processing time. The more data is in the pipe the slower this process.</p><h1 class="font-bold font-sans break-normal text-gray-900 text-1xl md:text-2xl pt-12"><strong>Unpredictability</strong></h1><p class="leading-8 mt-3">Using SELECT * on the client side even if you have a single field can introduce unpredictability. Think of this example, you have a table with one or two fields and your app does a SELECT * , blazing fast two integer fields.</p><p class="leading-8 mt-7">However, later the admin decided to add an XML field, JSON, blob and other fields that are populated and used by other apps. While your code did not change at all, it will suddenly slow down because it is now picking up all the extra fields that your app didn’t need to begin with.</p><h1 class="font-bold font-sans break-normal text-gray-900 text-1xl md:text-2xl pt-12">Summary</h1><p class="leading-8 mt-3">In conclusion, a SELECT * query involves many complex processes, so it’s best to only select the fields you need to avoid unnecessary overhead. Keep in mind that if your table has few columns with simple data types, the overhead of a SELECT * query might be negligible. However, it’s generally good practice to be selective about the columns you retrieve in your queries.</p><p class="leading-8 mt-7">Thank you.</p>
        <div class="flex flex-wrap gap-2 mt-5">
            <a title="Database" target="_blank" href="https://medium.com/tag/database"><span class="text-green-500 bg-green-100 px-2 py-1 rounded-full text-xs">#database</span></a><a title="Sql" target="_blank" href="https://medium.com/tag/sql"><span class="text-green-500 bg-green-100 px-2 py-1 rounded-full text-xs">#sql</span></a><a title="Data Science" target="_blank" href="https://medium.com/tag/data-science"><span class="text-green-500 bg-green-100 px-2 py-1 rounded-full text-xs">#data-science</span></a>
        </div>
        <div class="container w-full md:max-w-3xl mx-auto pt-12"></div>
    </div>
    <style>
code {
    /*font-size: 75%;*/
    background-color: #e3e2e2;
}
pre {
    font-size: 75%;
    background-color: #e3e2e2;
}
    </style>
<script>
  function navigateToOrigin() {
    window.location.href = window.location.origin;
  }
</script>

<script>
const h = document.documentElement, b = document.body;
const st = 'scrollTop';
const sh = 'scrollHeight';
const progress = document.getElementById('progress');
const header = document.getElementById('header');
const navcontent = document.getElementById('nav-content');

document.addEventListener('scroll', function () {
  /* Refresh scroll % width */
  const scroll = (h[st] || b[st]) / ((h[sh] || b[sh]) - h.clientHeight) * 100;
  progress.style.setProperty('--scroll', scroll + '%');

  /* Apply classes for slide in bar */
  const shouldAddClass = window.scrollY > 10;

  header.classList.toggle('bg-white', shouldAddClass);
  header.classList.toggle('shadow', shouldAddClass);
  navcontent.classList.toggle('bg-gray-100', !shouldAddClass);
  navcontent.classList.toggle('bg-white', shouldAddClass);
});

		document.getElementById('nav-toggle').onclick = function() {
			document.getElementById("nav-content").classList.toggle("hidden");
		}

  window.addEventListener('load', function () {
       Lightense('img:not(.no-lightense)');
  }, false);
</script>
</body>

</html>