<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title></title>
	
    <meta name="description" content="Your paywall breakthrough for medium.com!" />
    <meta name="keywords" content="medium, paywall, medium.com, paywall breakthrough" />
    <link rel="stylesheet" href="https://unpkg.com/tailwindcss@2.2.19/dist/tailwind.min.css"/>
	<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#00aba9">
<meta name="msapplication-TileColor" content="#00aba9">
<meta name="theme-color" content="#ffffff">
    <script src="https://cdn.jsdelivr.net/npm/lightense-images@1.0.17/dist/lightense.min.js"></script>
  </head>

<body class="bg-gray-100 font-sans leading-normal tracking-normal">
	<nav id="header" class="fixed w-full z-10 top-0">
	

		<div id="progress" class="h-1 z-20 top-0" style="background:linear-gradient(to right, #4dc0b5 var(--scroll), transparent 0);"></div>

		<div class="w-full md:max-w-4xl mx-auto flex flex-wrap items-center justify-between mt-0 py-3">

			<div class="pl-4">
				<a class="text-green-500 text-base no-underline hover:no-underline font-extrabold text-xl" href="/" onclick="navigateToOrigin()">
					Freedium Œ≤eta
				</a>
			</div>

			<div class="block lg:hidden pr-4">
				<button id="nav-toggle" class="flex items-center px-3 py-2 border rounded text-gray-500 border-gray-600 hover:text-gray-900 hover:border-green-500 appearance-none focus:outline-none">
					<svg class="fill-current h-3 w-3" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
						<title>Menu</title>
						<path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z" />
					</svg>
				</button>
			</div>

			<div class="w-full flex-grow lg:flex lg:items-center lg:w-auto hidden lg:block mt-2 lg:mt-0 bg-gray-100 z-20" id="nav-content">
				<ul class="list-reset lg:flex justify-end flex-1 items-center">
					<!--
					<li class="mr-3">
						<a class="inline-block py-2 px-4 text-gray-900 font-bold no-underline" href="#">Active</a>
					</li>
					-->
					<li class="mr-3">
						<a class="inline-block text-gray-600 no-underline hover:text-gray-900 hover:text-underline py-2 px-4" href="https://medium.com/">Medium.com</a>
					</li>
					<!--
					<li class="mr-3">
						<a class="inline-block text-gray-600 no-underline hover:text-gray-900 hover:text-underline py-2 px-4" href="#">link</a>
					</li>
				-->
				</ul>
			</div>
		</div>
	</nav>



<div class="container w-full md:max-w-3xl mx-auto pt-20 break-words">
    <div class="w-full px-4 md:px-6 text-xl text-gray-800 leading-normal" style="font-family:Georgia,serif">
        <div class="font-sans">
            <p class="text-base md:text-sm text-green-500 font-bold pb-3">
                <a href="https://medium.com/angular-in-depth/the-best-way-to-unsubscribe-rxjs-observable-in-the-angular-applications-d8f9aa42f6a0" class="text-sm md:text-sm text-green-500 font-bold no-underline hover:underline ">&lt; Go to the original</a>
            </p>
            
                <img alt="Preview image"
                     style="max-height: 65vh;
                            width: auto;
                            margin: auto"
                     loading="eager"
                     role="presentation"
                     src="https://miro.medium.com/v2/resize:fit:700/1*YGzm0X1JG4k_KDF9pSOi-w.jpeg">
            
            <h1 class="font-bold font-sans break-normal text-gray-900 pt-6 pb-2 text-3xl md:text-4xl">The Best Way To Unsubscribe RxJS Observable In The Angular Applications!</h1>
            <h2 class="font-medium font-sans break-normal text-gray-600 pt-1 pb-3 text-1xl md:text-1xl">There are many different ways how to handle RxJS subscriptions in Angular applications and we‚Äôre going to explore their pros and cons!</h2>
        </div>
        <div class="bg-gray-100 border border-gray-300 m-2">
            <div class="flex items-center space-x-4 p-4">
                <div class="flex-shrink-0">
                    <a href="https://medium.com/@tomastrajan" target="_blank" title="üëã I build, teach, write & speak about #Angular & #NgRx for enterprises üë®‚Äçüíª Google Developer Expert #GDE üë®‚Äçüè´ @AngularZurich meetup co-organizer" class="block relative">
                        <img src="https://miro.medium.com/v2/resize:fill:88:88/1*MfvHFyvZjqHRJDWlpv8n8Q.jpeg"
                             alt="Tomas Trajan"
                             class="rounded-full h-11 w-11 no-lightense">
                        <div class="absolute bottom-0 right-0 h-3 w-3 border-2 border-white bg-green-500 rounded-full"></div>
                    </a>
                </div>
                <div class="flex-grow">
                    <a href="https://medium.com/@tomastrajan"
                       target="_blank"
                       title="üëã I build, teach, write & speak about #Angular & #NgRx for enterprises üë®‚Äçüíª Google Developer Expert #GDE üë®‚Äçüè´ @AngularZurich meetup co-organizer"
                       class="block font-semibold text-gray-900">Tomas Trajan</a>
                    <button class="text-sm text-white bg-green-500 px-3 py-1 rounded-lg mt-1">
                        <a href="https://medium.com/@tomastrajan"
                           target="_blank"
                           title="üëã I build, teach, write & speak about #Angular & #NgRx for enterprises üë®‚Äçüíª Google Developer Expert #GDE üë®‚Äçüè´ @AngularZurich meetup co-organizer"
                           class="block text-sm text-white">Follow</a>
                    </button>
                </div>
            </div>
            <div class="px-4 pb-2">
                <div class="flex flex-wrap items-center space-x-2 text-sm text-gray-500">
                    
                        <a href="https://medium.com/angular-in-depth"
                           title="The place where advanced Angular concepts are explained"
                           target="_blank"
                           class="flex items-center space-x-1">
                            <img src="https://miro.medium.com/v2/resize:fill:48:48/1*t3JDHZ2k8OsouvWNOqco1Q.png"
                                 alt="Angular In Depth"
                                 class="h-4 w-4 rounded-full no-lightense">
                            <p>Angular In Depth</p>
                        </a>
                        <span>¬∑</span>
                    
                    <span class="text-gray-500">~13 min read</span>
                    <span class="md:inline">¬∑</span>
                    <span class="text-gray-500">January 8, 2019 (Updated: September 22, 2022)</span>
                    <span class="md:inline">¬∑</span>
                    <span class="text-yellow-500">Free: No</span>
                </div>
            </div>
        </div>
        <div class="mt-7"><img alt="None" style="margin: auto;" class="pt-5 lazy" role="presentation" data-src="https://miro.medium.com/v2/resize:fit:700/0*TSRYDjMNVBlZ-cfO.png"></div><blockquote style="box-shadow: inset 3px 0 0 0 #242424;" class="px-5 pt-3 pb-3 mt-5"><p style="font-style: italic;"><em><strong>AngularIn<em><a style="text-decoration: underline;" rel="noopener" title="" href="https://medium.com/angular-in-depth" target="_blank">Depth</strong></a></em></em><em><strong><em> is moving away from Medium. More recent articles are hosted on the new platform </strong></em><em><strong><em><a style="text-decoration: underline;" rel="noopener nofollow" title="" href="https://indepth.dev/angular/" target="_blank">inDepth.dev</a></em></strong></em><em><strong>. Thanks for being part of indepth movement!</em></strong></em></p></blockquote><h3 class="font-bold font-sans break-normal text-gray-900 text-1xl md:text-2xl pt-12">A Short Introduction To RxJS Observables</h3><h4 class="font-bold font-sans break-normal text-gray-900 text-l md:text-xl pt-8">(feel free to skip this part and get straight to the main courseüçî)</h4><p class="leading-8 mt-3">The <em>RxJS</em> (aka <code class='p-1'>Observable</code>-s ) is a rather new-ish technology in the frontend engineering space. Made popular mostly by its inclusion in the core Angular APIs. It proved to be a very powerful tool when dealing with the collections of asynchronous events.</p><blockquote class="mt-7 text-2xl ml-5" style="color: #6B6B6B;"><p>We can think of RxJS Observable as an potentially infinite async Array with all the conveniences we‚Äôre used to like filter or map and much more‚Ä¶</p></blockquote><h4 class="font-bold font-sans break-normal text-gray-900 text-l md:text-xl pt-8">Evolution Of Async Concepts</h4><p class="leading-8 mt-3">In the beginning, we started with simple callbacks. A callback is a function we pass as an argument to some other function. The callback will be then executed later, when something is done.</p><div class="mt-7"><img alt="None" style="margin: auto;" class="pt-5 lazy" role="presentation" data-src="https://miro.medium.com/v2/resize:fit:700/1*7OD4GedwPq8AGLJ0a_8XMw.png"></div><figcaption class='mt-3 text-sm text-center text-gray-500'>One of the most information-dense diagram ever created! Make sure to take your time to understand and internalize this!</figcaption><p class="leading-8 mt-7">Later, we were mostly working with promises. Promises always guaranteed to return single value, be it result or error. Once the value was resolved, handlers got executed and that was it. Everything was completed, cleaned up and we could move on.</p><p class="leading-8 mt-7">But then, everything changed forever. The frontend sages discovered the next piece of the push / pull puzzle‚Ä¶</p><blockquote style="box-shadow: inset 3px 0 0 0 #242424;" class="px-5 pt-3 pb-3 mt-5"><p style="font-style: italic;">With Observables, we‚Äôre now dealing with <strong>zero to many</strong> values over time.</p></blockquote><p class="leading-8 mt-7">Observables behavior necessitates a new way of consuming of the incoming values. We have to <strong>subscribe </strong>to the observable stream so that our handler gets called every time a new value is emitted.</p><p class="leading-8 mt-7">We can‚Äôt really know how many values will be coming beforehand. More so, some streams are potentially infinite (eg <em>user clicks</em>, <em>websocket messages</em>). This leads us to the realization that we have to manage the state of a subscriptions on our own.</p><blockquote class="mt-7 text-2xl ml-5" style="color: #6B6B6B;"><p>There are many different ways how to handle RxJS subscriptions in Angular applications</p></blockquote><p class="leading-8 mt-7">They provide different trade-offs in terms of verbosity, robustness or simplicity. In this article we‚Äôre going to explore many of this approaches . In general we will try to optimize our solution so that it is:</p><ul class="list-disc pl-8 mt-2"><li class='mt-3'><strong>concise ‚Äî </strong>minimize the amount of code we have to write and read</li><li class='mt-3'><strong>robust ‚Äî </strong>minimize the possibility of introducing bugs</li><li class='mt-3'><strong>simple ‚Äî </strong>easy to understand whats going on</li></ul><h3 class="font-bold font-sans break-normal text-gray-900 text-1xl md:text-2xl pt-12">What Are We Going To Learn?</h3><p class="leading-8 mt-3">On our journey we will go through various possible solutions to subscribing to RxJs Observable.</p><ol class="list-decimal pl-8 mt-2"><li class='mt-3'>The .subscribe() aka ‚Äú<em>The Memory Leak‚Äù</em></li><li class='mt-3'>The .unsubscribe()</li><li class='mt-3'>Let‚Äôs get declarative with <code class='p-1'>takeUntil</code></li><li class='mt-3'>Use the <code class='p-1'>take(1)</code> for initialization</li><li class='mt-3'>The fabled <code class='p-1'>| async</code> pipe</li><li class='mt-3'>The detour ‚Äî <code class='p-1'>| async</code> pipe taken too far üòµ</li><li class='mt-3'>The final destination ‚Äî NgRx Effects</li></ol><h3 class="font-bold font-sans break-normal text-gray-900 text-1xl md:text-2xl pt-12">1. The .subscribe() aka ‚ÄúThe Memory Leak‚Äù</h3><p class="leading-8 mt-3">Let‚Äôs start with the simplest example. We have a <code class='p-1'>timer</code> which is a infinite cold observable.</p><blockquote style="box-shadow: inset 3px 0 0 0 #242424;" class="px-5 pt-3 pb-3 mt-5"><p style="font-style: italic;">Cold Observable is an Observable which will do nothing by itself. Somebody has to subscribe to it to start its execution. Infinite means that once subscribed, observable will never <code class='p-1'>complete</code> .</p></blockquote><p class="leading-8 mt-7">We subscribe to the timer in <code class='p-1'>ngOnInit</code> method of a component and call <code class='p-1'>console.log</code> every time timer emits a new value.</p><div class="mt-7"><img alt="None" style="margin: auto;" class="pt-5 lazy" role="presentation" data-src="https://miro.medium.com/v2/resize:fit:700/1*Ev6zSXQW68zL_Lzp0hYxpw.png"></div><h4 class="font-bold font-sans break-normal text-gray-900 text-l md:text-xl pt-8">Why Is This A Memory Leak</h4><p class="leading-8 mt-3">Implementation looks good and does exactly what we expect. What would happen if we navigated to some other screen which is implemented using different components?</p><blockquote class="mt-7 text-2xl ml-5" style="color: #6B6B6B;"><p>The component will get destroyed but the subscription will live on</p></blockquote><p class="leading-8 mt-7">More logs will keep getting added to the browser console. More so, if we navigated back to the original route. The component would get recreated together with a new subscription.</p><blockquote style="box-shadow: inset 3px 0 0 0 #242424;" class="px-5 pt-3 pb-3 mt-5"><p style="font-style: italic;">We could repeat this process multiple times and the console output would get very very busyüòâ</p></blockquote><h4 class="font-bold font-sans break-normal text-gray-900 text-l md:text-xl pt-8">When Is It OK To Just Subscribe</h4><p class="leading-8 mt-3">Some components (eg <code class='p-1'>AppComponent</code>) and most of the services (with exception of services from lazy loaded modules and services provided in <code class='p-1'>@Component</code> decorator) in our Angular application will be instantiated <strong>only once </strong>during the application startup.</p><blockquote style="box-shadow: inset 3px 0 0 0 #242424;" class="px-5 pt-3 pb-3 mt-5"><p style="font-style: italic;">If we know that we‚Äôre dealing with such a case it is OK to subscribe to an Observable without providing any unsubscription logic.</p></blockquote><p class="leading-8 mt-7">These components and services will live for the whole duration of the application lifetime so they will not produce any memory leaks.</p><p class="leading-8 mt-7">Eventually, these subscriptions will get cleaned up when we navigate away from application to some other website.</p><h3 class="font-bold font-sans break-normal text-gray-900 text-1xl md:text-2xl pt-12"><strong>2. The .unsubscribe() Method</strong></h3><p class="leading-8 mt-3">OK, we figured out that we have probably implemented couple of accidental memory leaks and we‚Äôre eager to get rid of them ASAP!</p><blockquote style="box-shadow: inset 3px 0 0 0 #242424;" class="px-5 pt-3 pb-3 mt-5"><p style="font-style: italic;">The memory leaks are created when we destroy and recreate our components but we don‚Äôt clean up existing subscriptions. As we re-create our components we keep adding more and more subscriptions, hence the memory leak‚Ä¶</p></blockquote><p class="leading-8 mt-7">Subscribing to an observable yields us <code class='p-1'>Subscription</code> object which has an <code class='p-1'>unsubscribe()</code> method. This method can be used to remove the subscription when we no longer need it.</p><div class="mt-7"><img alt="None" style="margin: auto;" class="pt-5 lazy" role="presentation" data-src="https://miro.medium.com/v2/resize:fit:700/1*mHkTfLt9X_HASycCSfhNpQ.png"></div><figcaption class='mt-3 text-sm text-center text-gray-500'>Store reference to the original subscription and use imperative unsubscribe inside of ngOnDestory which gets called during the destruction of the component</figcaption><p class="leading-8 mt-7">Or we can get a bit more fancy with multiple subscriptions‚Ä¶</p><div class="mt-7"><img alt="None" style="margin: auto;" class="pt-5 lazy" role="presentation" data-src="https://miro.medium.com/v2/resize:fit:700/1*TH6-3pejPsEk-NVklnnCxQ.png"></div><figcaption class='mt-3 text-sm text-center text-gray-500'>Store multiple subscription references in the subscriptions array and unsubscribe all of them during ngOnDestroy</figcaption><p class="leading-8 mt-7">So is this really wrong? No, it works perfectly fine. The problem with this approach is that we‚Äôre mixing observable streams with plain old imperative logic.</p><blockquote style="box-shadow: inset 3px 0 0 0 #242424;" class="px-5 pt-3 pb-3 mt-5"><p style="font-style: italic;">In my experience, developers who are learning RxJS for the first time need to really be able to switch their perspective from imperative world view to <strong>thinking in streams</strong>. Handling stuff using an imperative approach when declarative ‚ÄúObservable friendly‚Äù alternative is available tends to slow down that learning process and therefore should be avoided!</p></blockquote><p class="leading-8 mt-7">Thanks to <a style="text-decoration: underline;" href="https://medium.com/u/9569ff590dd9">Wojciech Trawi≈Ñski</a> for enhancing this point by showing that there is a built in mechanism in the <code class='p-1'>Subscription</code> itself to make this happen. That being said I would still recommend to use more declarative approach to unsubscribing described later‚Ä¶</p><div class="mt-7"><img alt="None" style="margin: auto;" class="pt-5 lazy" role="presentation" data-src="https://miro.medium.com/v2/resize:fit:700/1*Sxc2HTkSL2YOGNw9wboNnA.png"></div><figcaption class='mt-3 text-sm text-center text-gray-500'>Collect subscriptions using subscription.add() method instead in array of subscriptions.</figcaption><h3 class="font-bold font-sans break-normal text-gray-900 text-1xl md:text-2xl pt-12">3. Let‚Äôs Get Declarative With takeUntil</h3><p class="leading-8 mt-3">So let‚Äôs move on and make our applications better with a help of the <code class='p-1'>takeUntil</code> RxJS operator (this will also make <a style="text-decoration: underline;" href="https://medium.com/u/da6839d28258">Ben Lesh</a> happy as a side-effect).</p><blockquote style="box-shadow: inset 3px 0 0 0 #242424;" class="px-5 pt-3 pb-3 mt-5"><p style="font-style: italic;">Official Docs: <code class='p-1'>takeUntil(notifier: Observable&lt;any&gt;)</code> ‚Äî Emits the values emitted by the source Observable <strong>until</strong> a <code class='p-1'>notifier</code> Observable emits a value.</p></blockquote><div class="mt-7"><img alt="None" style="margin: auto;" class="pt-5 lazy" role="presentation" data-src="https://miro.medium.com/v2/resize:fit:700/1*7CvCZNXHJwnm8uORNIZJug.png"></div><figcaption class='mt-3 text-sm text-center text-gray-500'>Note that we are using .pipe() method of the observable to add operators, in our case takeUntil to the observable chain</figcaption><p class="leading-8 mt-7">This solution is <strong>declarative</strong>! This means that we declare our Observable chain before hand with everything that it needs to accommodate for the whole life cycle from start to end.</p><blockquote class="mt-7 text-2xl ml-5" style="color: #6B6B6B;"><p>The takeUntil() solution is great but unfortunately it comes also with a couple of disadvantages</p></blockquote><p class="leading-8 mt-7">Most obviously, it‚Äôs quite verbose ! We have to create additional <code class='p-1'>Subject</code> and correctly implement <code class='p-1'>OnDestroy</code> interface in every component of our application which is quite a lot!</p><p class="leading-8 mt-7">Even bigger problem is that it is a quite error prone process. It is <strong>VERY </strong>easy to forget to implement <code class='p-1'>OnDestroy</code> interface. And this itself can go wrong in two different ways‚Ä¶</p><ol class="list-decimal pl-8 mt-2"><li class='mt-3'>Forgetting to implement the <code class='p-1'>OnDestroy</code> interface itself</li><li class='mt-3'>Forgetting to call <code class='p-1'>.next()</code> and <code class='p-1'>.complete()</code> methods in the <strong>ngOnDestroy</strong> implementation (leaving it empty)</li></ol><blockquote style="box-shadow: inset 3px 0 0 0 #242424;" class="px-5 pt-3 pb-3 mt-5"><p style="font-style: italic;">In case you‚Äôre saying that you will just always check for it, sure, I was thinking the same until I discovered couple of memory leaks in one of my applications with exactly this issue!</p></blockquote><p class="leading-8 mt-7">The largest problem with this is that these two things will <strong>NOT</strong> result in any obvious errors whatsoever so they are very easy to miss!</p><p class="leading-8 mt-7">A possible solution would be to implement (or find if it exists) a custom <code class='p-1'>tslint</code> rule which will check for missing (or empty) <code class='p-1'>ngOnDestroy()</code> methods in every component which can also be problematic because not every component uses subscriptions‚Ä¶</p><blockquote style="box-shadow: inset 3px 0 0 0 #242424;" class="px-5 pt-3 pb-3 mt-5"><p style="font-style: italic;">Many thanks to <a style="text-decoration: underline;" href="https://medium.com/u/47bf7ba33d18">Brian Love</a> for feedback. We should not forget about the fact that the <code class='p-1'>takeUntil</code> operator has to be last operator in the <code class='p-1'>pipe</code> (usually) to prevent situation when subsequent operator return additional observables which can prevent clean up.</p></blockquote><h3 class="font-bold font-sans break-normal text-gray-900 text-1xl md:text-2xl pt-12">4. The take(1) For Initialization</h3><p class="leading-8 mt-3">Some subscriptions only have to happen <strong>once </strong>during the application startup. They might be needed to kick-start some processing or fire the first request to load the initial data.</p><p class="leading-8 mt-7">In such scenarios we can use RxJS <code class='p-1'>take(1)</code> operator which is great because it automatically unsubscribes after the first execution.</p><div class="mt-7"><img alt="None" style="margin: auto;" class="pt-5 lazy" role="presentation" data-src="https://miro.medium.com/v2/resize:fit:700/1*-My-M11eBhIXq9UOUzSZrw.png"></div><figcaption class='mt-3 text-sm text-center text-gray-500'>We‚Äôre triggering initial search for results based on stored query and every additional search will be result of user interaction. (For example there will be a (onchange)=‚ÄùsearchResult($event.target.value)‚Äù in the component template)</figcaption><blockquote style="box-shadow: inset 3px 0 0 0 #242424;" class="px-5 pt-3 pb-3 mt-5"><p style="font-style: italic;">The operator itself is <code class='p-1'>take(n: number)</code> so we could pass any number, but for our scenario the number 1 is all what we need!</p></blockquote><p class="leading-8 mt-7">Please note that the <code class='p-1'>take(1)</code> will not fire (and complete the observable stream) in case the original observable never emits. We have to make sure we only use it in cases where this can‚Äôt happen or provide additional unsubscription handling! Thanks <a style="text-decoration: underline;" href="https://medium.com/u/47bf7ba33d18">Brian Love</a> for feedback!</p><p class="leading-8 mt-7">Also it might be worth using <code class='p-1'>first()</code> operator which does exactly how it sounds. Additionally, the operators supports passing of a predicate so its kinda like a combination of <code class='p-1'>filter</code> and <code class='p-1'>take(1)</code>.</p><blockquote style="box-shadow: inset 3px 0 0 0 #242424;" class="px-5 pt-3 pb-3 mt-5"><p style="font-style: italic;">Great feedback from <a style="text-decoration: underline;" href="https://medium.com/u/f37322e7b9c1">Rokas Brazdzionis</a>: Just keep in mind that <code class='p-1'>take(1)</code> still doesn‚Äôt unsubscribe when component is being destroyed. The subscription remains active until first value is emitted no matter if component is active or destroyed. So if we do something more crazy, like accessing the DOM, in our subscription ‚Äî we might end up with an error in the console.</p></blockquote><blockquote class="mt-7 text-2xl ml-5" style="color: #6B6B6B;"><p><a style="text-decoration: underline;" rel="noopener nofollow noopener noopener noopener nofollow noopener noopener noopener nofollow noopener" title="" href="https://twitter.com/tomastrajan" target="_blank"><em>Follow me on Twitter</em></a><em> to get notified about the newest Angular blog posts and interesting frontend stuff!üê§</em></p></blockquote><h3 class="font-bold font-sans break-normal text-gray-900 text-1xl md:text-2xl pt-12">Sidenote ‚Äî The &lt;ng-container&gt; element</h3><p class="leading-8 mt-3">Before we venture further, let‚Äôs talk a bit about the <code class='p-1'>&lt;ng-container&gt;</code> element. The element is special in that it doesn‚Äôt produce any corresponding <code class='p-1'>DOM</code> element. This makes it a perfect tool for implementation of the conditional parts of a template which will come very handy in our next scenario.</p><div class="mt-7"><img alt="None" style="margin: auto;" class="pt-5 lazy" role="presentation" data-src="https://miro.medium.com/v2/resize:fit:700/1*bGpc4O2roZz7MCLdkleoxw.png"></div><figcaption class='mt-3 text-sm text-center text-gray-500'>Example of using <ng-container> element to unwrap observable stream and story it in a variable</figcaption><h3 class="font-bold font-sans break-normal text-gray-900 text-1xl md:text-2xl pt-12">5. The Fabled | async Pipe</h3><p class="leading-8 mt-3">Angular comes with built in support for pipes. A pipe is neat little abstraction and corresponding syntax which enables us to decouple implementation of various data transforms which then can be used in templates of multiple components.</p><blockquote style="box-shadow: inset 3px 0 0 0 #242424;" class="px-5 pt-3 pb-3 mt-5"><p style="font-style: italic;">One useful example would be <code class='p-1'>| json</code> pipe which is provided out of the box and enables us to display content of Javascript objects. We can use it in a template like this <code class='p-1'>{{ someObject | json }}</code> .</p></blockquote><p class="leading-8 mt-7">This brings us to the <code class='p-1'>| async</code> pipe which subscribes to the provided Observable behind the scenes and gives us unwrapped plain old Javascript value. This value then can be used in the template as per usual.</p><p class="leading-8 mt-7">In addition to that, all the subscriptions initiated by the <code class='p-1'>| async</code> pipe are automatically unsubscribed when the component is destroyed. That‚Äôs a perfect situation and we can easily consume async data without any possibility to introduce memory leaks!</p><blockquote class="mt-7 text-2xl ml-5" style="color: #6B6B6B;"><p><code class='p-1'>The | async</code> pipes automatically unsubscribes all active subscriptions when component is destroyed</p></blockquote><div class="mt-7"><img alt="None" style="margin: auto;" class="pt-5 lazy" role="presentation" data-src="https://miro.medium.com/v2/resize:fit:700/1*YsD7gF3mCDEyBLtf8P_WEQ.png"></div><figcaption class='mt-3 text-sm text-center text-gray-500'>Example of using | async pipe to unwrap stream of todoState to use it in the template</figcaption><p class="leading-8 mt-7">Another big advantage of using <code class='p-1'>| async</code> pipe together with <code class='p-1'>*ngIf</code> directive is that we can guarantee that the unwrapped value will be available to all child components at the time they are rendered.</p><p class="leading-8 mt-7">Such an approach helps us to prevent excessive use of ‚Äúelvis‚Äù operator (<code class='p-1'>?.</code>)in our templates which is used to get rid <code class='p-1'>prop of undefined</code> errors... Without <code class='p-1'>&lt;ng-container&gt;</code> it would look more like this‚Ä¶</p><div class="mt-7"><img alt="None" style="margin: auto;" class="pt-5 lazy" role="presentation" data-src="https://miro.medium.com/v2/resize:fit:700/1*M9ea4WldaytjQBXDAPgGFA.png"></div><figcaption class='mt-3 text-sm text-center text-gray-500'>Using of a ‚Äúelvis‚Äù ‚Äî ?. operator to prevent ‚Äúprop of undefined‚Äù errors.</figcaption><h3 class="font-bold font-sans break-normal text-gray-900 text-1xl md:text-2xl pt-12">6. The Detour ‚Äî | async Pipe Taken Too Far üòµ</h3><p class="leading-8 mt-3">As goes one funny saying‚Ä¶</p><blockquote class="mt-7 text-2xl ml-5" style="color: #6B6B6B;"><p>The scientists were so focused on whether they could make it work that they forget to ask themselves if they should‚Ä¶</p></blockquote><blockquote style="box-shadow: inset 3px 0 0 0 #242424;" class="px-5 pt-3 pb-3 mt-5"><p style="font-style: italic;">The same situation happened to me while working on the <a style="text-decoration: underline;" rel="" title="" href="https://github.com/tomastrajan/angular-ngrx-material-starter" target="_blank">Angular NgRx Material Starter</a> on my quest to remove every single <code class='p-1'>OnDestroy</code> / <code class='p-1'>takeUntil</code> occurrence. I came up with a funny working solution, but I would not really recommend it, but who knows? Let‚Äôs have a look anywayüòÇ</p></blockquote><h4 class="font-bold font-sans break-normal text-gray-900 text-l md:text-xl pt-8">The Context</h4><p class="leading-8 mt-3">The previous solution with <code class='p-1'>| async</code> pipe works perfectly for any use case when we need to get hold of the data which is available as a Observable with the intention of displaying it in our UI.</p><p class="leading-8 mt-7">This works really well and the unwrapped data is available in the template so we can use it freely to display it and also to pass it to the component methods. The only missing thing is the triggering (calling) of said methods.</p><p class="leading-8 mt-7">Usually this will be the responsibility of our users and their interaction with our component. Let‚Äôs say we want to toggle our todo item‚Ä¶</p><div class="mt-7"><img alt="None" style="margin: auto;" class="pt-5 lazy" role="presentation" data-src="https://miro.medium.com/v2/resize:fit:700/1*IAFn6Sxbt2t0FBiPW-VOsA.png"></div><figcaption class='mt-3 text-sm text-center text-gray-500'>The toggle() method is triggered by user interaction</figcaption><p class="leading-8 mt-7">The unwrapped data is available in the template and it will be passed to the <code class='p-1'>todoService</code> as a result of user interaction.</p><p class="leading-8 mt-7">What about cases when we need to trigger something as a reaction to the data itself so we can‚Äôt rely on users to do it for us? That would be a perfect fit for using <code class='p-1'>.subscribe()</code>, right?</p><div class="mt-7"><img alt="None" style="margin: auto;" class="pt-5 lazy" role="presentation" data-src="https://miro.medium.com/v2/resize:fit:700/1*tUdwyJexDvIYr2z8Dez-yg.png"></div><figcaption class='mt-3 text-sm text-center text-gray-500'>Using subscribe to set new browser title as a reaction to navigation</figcaption><p class="leading-8 mt-7">But our goal was to <strong>NOT </strong>use <code class='p-1'>.subscribe()</code> or at least to remove the need to manually unsubscribe‚Ä¶</p><blockquote class="mt-7 text-2xl ml-5" style="color: #6B6B6B;"><p>Psst‚Ä¶ there is a way!</p></blockquote><div class="mt-7"><img alt="None" style="margin: auto;" class="pt-5 lazy" role="presentation" data-src="https://miro.medium.com/v2/resize:fit:700/1*tAaWmJNM8O9MxBG_X_qvlQ.png"></div><figcaption class='mt-3 text-sm text-center text-gray-500'>Enter the | async pipe based side effects üòπ</figcaption><p class="leading-8 mt-7">So what do we have here?</p><p class="leading-8 mt-7">We‚Äôre using <code class='p-1'>| async</code> pipe to subscribe to the Observable and instead of displaying any content we‚Äôre evaluating (executing)<code class='p-1'>{{ }}</code> our <code class='p-1'>updateTitle()</code> component method every time a new value is pushed by the Observable stream.</p><blockquote style="box-shadow: inset 3px 0 0 0 #242424;" class="px-5 pt-3 pb-3 mt-5"><p style="font-style: italic;">In the example above, we are not passing any value to the called method but it is possible‚Ä¶ We could do something like this: <code class='p-1'>&lt;ng-container *ngIf=&quot;someStream$ | async as value&quot;&gt;{{doStuff(value)}}&lt;/ng-container&gt;</code> .</p></blockquote><h4 class="font-bold font-sans break-normal text-gray-900 text-l md:text-xl pt-8">Advantages</h4><ul class="list-disc pl-8 mt-2"><li class='mt-3'>less code and concepts (no <code class='p-1'>Subject</code> with <code class='p-1'>.next()</code> and <code class='p-1'>.complete()</code>, no <code class='p-1'>OnDestroy</code>, no <code class='p-1'>takeUntil</code>)</li><li class='mt-3'>can‚Äôt forget to implement (or make mistake) in <code class='p-1'>OnDestroy</code> / <code class='p-1'>takeUntil</code></li><li class='mt-3'>subscriptions always happen in the template (locality)</li></ul><h4 class="font-bold font-sans break-normal text-gray-900 text-l md:text-xl pt-8">Disadvantages</h4><ul class="list-disc pl-8 mt-2"><li class='mt-3'>has to be used with <code class='p-1'>OnPush</code> change detection strategy (or else it will call function on every change detection cycle)</li><li class='mt-3'>it‚Äôs weird (subjective)</li><li class='mt-3'>probably was not meant to be used like that</li><li class='mt-3'>there is a better way‚Ä¶ üòâ</li></ul><div class="mt-7"><img alt="Angular Experts‚Ää‚Äî‚ÄäSupercharge your Angular application development with our expert support. Proven architecture, best practices and quality control ensure your team delivers an exceptional experience every time." style="margin: auto;" class="pt-5 lazy" role="presentation" data-src="https://miro.medium.com/v2/resize:fit:700/0*u9HEg4VyUkA6ntxF.png"></div><figcaption class='mt-3 text-sm text-center text-gray-500'>Welcome to the world of Angular excellence ‚Äî angularexperts.ch</figcaption><blockquote style="box-shadow: inset 3px 0 0 0 #242424;" class="px-5 pt-3 pb-3 mt-5"><p style="font-style: italic;"><strong><em>Do you find the information in this article useful?</em></strong></p></blockquote><blockquote style="box-shadow: inset 3px 0 0 0 #242424;" class="px-5 pt-3 pb-3 mt-5"><p style="font-style: italic;"><em>We are providing tailored expert support for developing of your Angular applications. Explore our wide range offers on </em><em><a style="text-decoration: underline;" rel="noopener ugc nofollow" title="" href="https://www.angularexperts.ch/" target="_blank">angularexperts.ch</a></em></p></blockquote><h3 class="font-bold font-sans break-normal text-gray-900 text-1xl md:text-2xl pt-12">7. The Final Destination ‚Äî NgRx Effects</h3><p class="leading-8 mt-3">In the previous solution, we were trying to make something happen outside of the components template with the help of an <code class='p-1'>| async</code> pipe. Stuff happening outside or let‚Äôs say ‚Äúon the side‚Äù sounds very much like a hint pointing to the concept of <strong>side-effects</strong>.</p><blockquote style="box-shadow: inset 3px 0 0 0 #242424;" class="px-5 pt-3 pb-3 mt-5"><p style="font-style: italic;">In this post, we are dealing mostly with the plain RxJS but Angular ecosystem contains also NgRx, a state management library based on RxJS primitives which implements one way data flow (Flux / Redux pattern)</p></blockquote><p class="leading-8 mt-7">NgRx Effects can help us to remove last explicit <code class='p-1'>.subscribe()</code> calls from our apps (without the need for template based side-effects)! Effects are implemented in isolation and are subscribed automatically by the library.</p><p class="leading-8 mt-7">Let‚Äôs have a look on example of how would such an implementation look like‚Ä¶</p><div class="mt-7"><img alt="None" style="margin: auto;" class="pt-5 lazy" role="presentation" data-src="https://miro.medium.com/v2/resize:fit:700/1*RA_G2KQaFTv-KpMHCEOlqg.png"></div><figcaption class='mt-3 text-sm text-center text-gray-500'>Implementation of NgRx effect. This would still needed to be imported in some NgModule with EffectsModule.forFeature([TitleEffects, ‚Ä¶])</figcaption><p class="leading-8 mt-7">The Observable stream of actions (or any other stream) will be subscribed and managed by the library so we don‚Äôt have to implement any unsubscribe logic. Yaay üéâ!</p><blockquote class="mt-7 text-2xl ml-5" style="color: #6B6B6B;"><p>Side-effects implemented with the help of NgRx Effects are independent from the component life-cycle which prevents memory leaks and host of other problems!</p></blockquote><p class="leading-8 mt-7">As a bonus, using NgRx Effects means we are dealing with the side-effects as well defined concept which leads to cleaner architecture, promotes maintainability and it‚Äôs much easier to test!</p><blockquote style="box-shadow: inset 3px 0 0 0 #242424;" class="px-5 pt-3 pb-3 mt-5"><p style="font-style: italic;">Do you think that NgRx or Redux are overkill for your needs? Looking for something simpler? Check out <a style="text-decoration: underline;" rel="noopener" title="" href="https://www.npmjs.com/package/@angular-extensions/model" target="_blank">@angular-extensions/model</a> library!</p></blockquote><div class="mt-7"><img alt="None" style="margin: auto;" class="pt-5 lazy" role="presentation" data-src="https://miro.medium.com/v2/resize:fit:700/1*9rjSJjSmjqL93X2htGYHQg.png"></div><figcaption class='mt-3 text-sm text-center text-gray-500'>Try out @angular-extensions/model library! Check out docs & Github</figcaption><h3 class="font-bold font-sans break-normal text-gray-900 text-1xl md:text-2xl pt-12">Recapitulation</h3><ol class="list-decimal pl-8 mt-2"><li class='mt-3'>RxJS is a powerful tool to manage collections of async events.</li><li class='mt-3'>We subscribe to event streams which can emit zero to many values and can be potentially infinite.</li><li class='mt-3'>This leaves us with the need to manage unsubscription manually</li><li class='mt-3'>Memory leaks are result of incorrect unsubscription implementation</li><li class='mt-3'>There are many ways to unsubscribe from Observable streams in Angular</li><li class='mt-3'>Different approaches provide us with different trade-offs</li><li class='mt-3'>In general it is best to use <code class='p-1'>| async</code> pipe to subscribe and unwrap values in the component templates (with help of <code class='p-1'>&lt;ng-container&gt;</code> element)</li><li class='mt-3'>The <code class='p-1'>| async</code> pipe can be used also to trigger side effects but there is a better way</li><li class='mt-3'>Use NgRx Effects to implement side-effects which should be triggered in response to Observable streams!</li></ol><h3 class="font-bold font-sans break-normal text-gray-900 text-1xl md:text-2xl pt-12">That‚Äôs It For Today!</h3><blockquote style="box-shadow: inset 3px 0 0 0 #242424;" class="px-5 pt-3 pb-3 mt-5"><p style="font-style: italic;">I hope you enjoyed this article and will now be able to handle subscriptions in your Angular applications with ease!</p></blockquote><p class="leading-8 mt-7">Please support this guide with your üëèüëèüëè using the clap button on the upper left side and help it spread to a wider audience üôè Also, don‚Äôt hesitate to ping me if you have any questions using the article responses or Twitter DMs <a style="text-decoration: underline;" rel="nofollow noopener noopener" title="" href="https://twitter.com/tomastrajan" target="_blank">@tomastrajan</a>.</p><blockquote class="mt-7 text-2xl ml-5" style="color: #6B6B6B;"><p>And never forget, future is bright</p></blockquote><div class="mt-7"><img alt="None" style="margin: auto;" class="pt-5 lazy" role="presentation" data-src="https://miro.medium.com/v2/resize:fit:700/1*rwyFGht9u_IzChMsPLD6dw.jpeg"></div><figcaption class='mt-3 text-sm text-center text-gray-500'>Obviously the bright future! (üì∏ by Vitalii Ustymenko)</figcaption><blockquote style="box-shadow: inset 3px 0 0 0 #242424;" class="px-5 pt-3 pb-3 mt-5"><p style="font-style: italic;">Starting an Angular project? Check out <a style="text-decoration: underline;" rel="noopener nofollow" title="" href="https://github.com/tomastrajan/angular-ngrx-material-starter" target="_blank">Angular NgRx Material Starter</a>!</p></blockquote><div class="mt-7"><img alt="None" style="margin: auto;" class="pt-5 lazy" role="presentation" data-src="https://miro.medium.com/v2/resize:fit:700/1*jny3NETBblGCQW0EYKAMNQ.png"></div><figcaption class='mt-3 text-sm text-center text-gray-500'>Angular NgRx Material Starter with built in best practices, theming and much more!</figcaption><p class="leading-8 mt-7">If you made it this far, feel free to check out some of my other articles about Angular and frontend software development in general‚Ä¶</p>
<div class="flex border border-gray-300 p-2 mt-7 justify-center items-center overflow-hidden"><a rel="noopener follow" href="https://medium.com/@tomastrajan/total-guide-to-angular-6-dependency-injection-providedin-vs-providers-85b7a347b59f" target="_blank"> <div class="flex flex-row justify-between p-2 overflow-hidden"><div class="flex flex-col justify-center p-2"><h2 class="text-black text-base font-bold">Total Guide To Angular 6+ Dependency Injection ‚Äî providedIn vs providers:[ ] üíâ
</h2><div class="mt-2 block"><h3 class="text-grey-darker text-sm">et‚Äôs learn when and how to use new better Angular 6+ dependency injection mechanism with new providedIn syntax to make‚Ä¶m</h3></div><div class="mt-5" style=""><p class="text-grey-darker text-xs">medium.com</p></div></div><div class="relative flex flew-row h-40 w-72"><div class="lazy absolute inset-0 bg-cover bg-center" data-bg="https://miro.medium.com/v2/resize:fit:320/1*UfgFDv5qOPGjzUjqzmBHCQ.jpeg"></div></div></div> </a></div>
<div class="flex border border-gray-300 p-2 mt-7 justify-center items-center overflow-hidden"><a rel="noopener follow" href="https://blog.angularindepth.com/angular-question-rxjs-subscribe-vs-async-pipe-in-component-templates-c956c8c0c794" target="_blank"> <div class="flex flex-row justify-between p-2 overflow-hidden"><div class="flex flex-col justify-center p-2"><h2 class="text-black text-base font-bold">The Ultimate Answer To The Very Common Angular Question: subscribe() vs | async Pipe</h2><div class="mt-2 block"><h3 class="text-grey-darker text-sm">Most of the popular Angular state management libraries like NgRx expose application state in a form of a stream of‚Ä¶</h3></div><div class="mt-5" style=""><p class="text-grey-darker text-xs">angularindepth.com</p></div></div><div class="relative flex flew-row h-40 w-72"><div class="lazy absolute inset-0 bg-cover bg-center" data-bg="https://miro.medium.com/v2/resize:fit:320/1*5vQWDFbChZDlvONLHCrhxA.jpeg"></div></div></div> </a></div>
<div class="flex border border-gray-300 p-2 mt-7 justify-center items-center overflow-hidden"><a rel="noopener follow" href="https://blog.angularindepth.com/total-guide-to-dynamic-angular-animations-that-can-be-toggled-at-runtime-be5bb6778a0a" target="_blank"> <div class="flex flex-row justify-between p-2 overflow-hidden"><div class="flex flex-col justify-center p-2"><h2 class="text-black text-base font-bold">Total Guide To Dynamic Angular Animations That Can Be Customized At Runtime</h2><div class="mt-2 block"><h3 class="text-grey-darker text-sm">Animations make projects look much better</h3></div><div class="mt-5" style=""><p class="text-grey-darker text-xs">angularindepth.com</p></div></div><div class="relative flex flew-row h-40 w-72"><div class="lazy absolute inset-0 bg-cover bg-center" data-bg="https://miro.medium.com/v2/resize:fit:320/1*qqWICkKpxftiDgWlFgybDg.jpeg"></div></div></div> </a></div>
<div class="flex border border-gray-300 p-2 mt-7 justify-center items-center overflow-hidden"><a rel="noopener follow" href="https://medium.com/dailyjs/how-did-angular-cli-budgets-save-my-day-and-how-they-can-save-yours-300d534aae7a" target="_blank"> <div class="flex flex-row justify-between p-2 overflow-hidden"><div class="flex flex-col justify-center p-2"><h2 class="text-black text-base font-bold">How Did Angular CLI Budgets Save My Day And How They Can Save Yours</h2><div class="mt-2 block"><h3 class="text-grey-darker text-sm">Budgets is one of the less known features of the Angular CLI which helps you to keep application bundle sizes in check‚Ä¶</h3></div><div class="mt-5" style=""><p class="text-grey-darker text-xs">medium.com</p></div></div><div class="relative flex flew-row h-40 w-72"><div class="lazy absolute inset-0 bg-cover bg-center" data-bg="https://miro.medium.com/v2/resize:fit:320/1*LC4ng2ZHqtIJQoHglETEmg.jpeg"></div></div></div> </a></div>
        <div class="flex flex-wrap gap-2 mt-5">
            <a title="JavaScript" target="_blank" href="https://medium.com/tag/javascript"><span class="text-green-500 bg-green-100 px-2 py-1 rounded-full text-xs">#javascript</span></a><a title="Angular" target="_blank" href="https://medium.com/tag/angular"><span class="text-green-500 bg-green-100 px-2 py-1 rounded-full text-xs">#angular</span></a><a title="Typescript" target="_blank" href="https://medium.com/tag/typescript"><span class="text-green-500 bg-green-100 px-2 py-1 rounded-full text-xs">#typescript</span></a><a title="Angular2" target="_blank" href="https://medium.com/tag/angular2"><span class="text-green-500 bg-green-100 px-2 py-1 rounded-full text-xs">#angular2</span></a><a title="Rxjs" target="_blank" href="https://medium.com/tag/rxjs"><span class="text-green-500 bg-green-100 px-2 py-1 rounded-full text-xs">#rxjs</span></a>
        </div>
        <div class="container w-full md:max-w-3xl mx-auto pt-12"></div>
    </div>
    <style>
code {
    /*font-size: 75%;*/
    background-color: #e3e2e2;
}
pre {
    font-size: 75%;
    background-color: #e3e2e2;
}
    </style>
<script>
  function navigateToOrigin() {
    window.location.href = window.location.origin;
  }
</script>

<script>
const h = document.documentElement, b = document.body;
const st = 'scrollTop';
const sh = 'scrollHeight';
const progress = document.getElementById('progress');
const header = document.getElementById('header');
const navcontent = document.getElementById('nav-content');

document.addEventListener('scroll', function () {
  /* Refresh scroll % width */
  const scroll = (h[st] || b[st]) / ((h[sh] || b[sh]) - h.clientHeight) * 100;
  progress.style.setProperty('--scroll', scroll + '%');

  /* Apply classes for slide in bar */
  const shouldAddClass = window.scrollY > 10;

  header.classList.toggle('bg-white', shouldAddClass);
  header.classList.toggle('shadow', shouldAddClass);
  navcontent.classList.toggle('bg-gray-100', !shouldAddClass);
  navcontent.classList.toggle('bg-white', shouldAddClass);
});

		document.getElementById('nav-toggle').onclick = function() {
			document.getElementById("nav-content").classList.toggle("hidden");
		}

  window.addEventListener('load', function () {
       Lightense('img:not(.no-lightense)');
  }, false);
</script>
</body>

</html>